import os
from dotenv import load_dotenv
from static_analysis import static_analysis
from dynamic_analysis import cuckoo_parser
from utils import file_utils

# .env 파일 로드
load_dotenv(dotenv_path='.env')


if __name__ == "__main__":
    job = os.getenv('JOB')

    # Static analysis and parsing CSV file
    if job == 'STATIC_ANALYSIS':
        static_analysis.main(os.getenv('BODMAS_RAW_DIR'), os.getenv('BODMAS_STATIC_FEATURE_PATH'))
        static_analysis.main(os.getenv('KISA_RAW_DIR'), os.getenv('KISA_STATIC_FEATURE_PATH'))
        static_analysis.main(os.getenv('VS_RAW_DIR'), os.getenv('VS_STATIC_FEATURE_PATH'))
        static_analysis.main(os.getenv('BENIGN_RAW_DIR'), os.getenv('BENIGN_STATIC_FEATURE_PATH'))
    # Cuckoo report parsing
    elif job == 'CUCKOO_REPORTS_PARSING':
        cuckoo_parser.main(os.getenv('BODMAS_CUCKOO_REPORTS_DIR'), os.getenv('BODMAS_DYNAMIC_FEATURE_PATH'))
        cuckoo_parser.main(os.getenv('KISA_CUCKOO_REPORTS_DIR'), os.getenv('KISA_DYNAMIC_FEATURE_PATH'))
        cuckoo_parser.main(os.getenv('VS_CUCKOO_REPORTS_DIR'), os.getenv('VS_DYNAMIC_FEATURE_PATH'))
        cuckoo_parser.main(os.getenv('BENIGN_CUCKOO_REPORTS_DIR'), os.getenv('BENIGN_DYNAMIC_FEATURE_PATH'))
        cuckoo_parser.main(os.getenv('TEST_CUCKOO_REPORTS_DIR'), os.getenv('TEST_DYNAMIC_FEATURE_PATH'))
    elif job == 'MOVE_REPORTS':
        file_utils.main()
    else:
        print("Select job... 종류... 에드워드... 오빠...")