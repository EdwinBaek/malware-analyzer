import os
from dotenv import load_dotenv
from static_analysis import static_analysis
from utils import file_utils

# .env 파일 로드
load_dotenv(dotenv_path='.env')

def static_analysis_main():
    try:
        static_analysis.analyze_dataset(os.getenv('DATASET_PATH'), os.getenv('DATASET_PATH'))
    except ValueError as e:
        print(f"오류: {e}")

def cuckoo_reports_parsing_main():
    try:
        print("...")
    except ValueError as e:
        print(f"오류: {e}")

def move_reports_main(src, dst):
    try:
        file_utils.move_reports(src, dst)
    except ValueError as e:
        print(f"오류: {e}")

if __name__ == "__main__":
    job = os.getenv('JOB')
    if job == 'STATIC_ANALYSIS':
        # Static analysis and parsing CSV file
        static_analysis_main()
    elif job == 'CUCKOO_REPORTS_PARSING':
        #
        cuckoo_reports_parsing_main()
    elif job == 'MOVE_REPORTS':
        # BODMAS dataset
        bodmas_dst_path = './dataset/reports/BODMAS'
        move_reports_main('./dataset/Cuckoo_Reports/BODMAS/bodmas1_reports', bodmas_dst_path)    # 11,261개
        move_reports_main('./dataset/Cuckoo_Reports/BODMAS/bodmas3_reports', bodmas_dst_path)    # 9,004개
        move_reports_main('./dataset/Cuckoo_Reports/BODMAS/bodmas4_reports', bodmas_dst_path)    # 8,926개
        move_reports_main('./dataset/Cuckoo_Reports/BODMAS/bodmas5_reports', bodmas_dst_path)    # 9,004개
        move_reports_main('./dataset/Cuckoo_Reports/BODMAS/bodmas6_reports', bodmas_dst_path)    # 9,006개

        # KISA dataset
        kisa_dst_path = './dataset/reports/KISA'
        move_reports_main('./dataset/Cuckoo_Reports/KISA/kisa1_reports', kisa_dst_path)    # 591개
        move_reports_main('./dataset/Cuckoo_Reports/KISA/kisa2_reports', kisa_dst_path)    # 2,441개
        move_reports_main('./dataset/Cuckoo_Reports/KISA/kisa3_reports', kisa_dst_path)    # 9,977개
        move_reports_main('./dataset/Cuckoo_Reports/KISA/kisa4_reports', kisa_dst_path)    # 10,686개
        move_reports_main('./dataset/Cuckoo_Reports/KISA/kisa5_reports/kisa4_reports', kisa_dst_path)    # 592개

        # VirusShare dataset
        vs_dst_path = './dataset/reports/VirusShare'
        move_reports_main('./dataset/Cuckoo_Reports/VirusShare/vs1_reports', vs_dst_path)    # 1,996개