FROM ubuntu:20.04

# Install dependencies
RUN apt-get update && apt-get install -y \
    python3 python3-pip python3-dev \
    libffi-dev libssl-dev \
    curl \
    redis-server

# Install Celery and analysis tools
RUN pip3 install celery redis pefile requests

# Create analysis user
RUN useradd -m -s /bin/bash analyst
USER analyst
WORKDIR /home/analyst

# Copy scripts and configuration
COPY . /home/analyst/

# Install Python dependencies
RUN pip3 install -r requirements.txt

# Run Redis
CMD service redis-server start
